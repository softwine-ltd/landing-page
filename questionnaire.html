<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Architecture Consultation Bot</title>
    <style>
        .chat-container {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 350px;
            height: 500px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            display: none;
            flex-direction: column;
            overflow: hidden;
            font-family: Arial, sans-serif;
        }

        .chat-header {
            background: #51A5D7;
            color: white;
            padding: 15px;
            font-weight: bold;
        }

        .chat-messages {
            flex-grow: 1;
            padding: 15px;
            overflow-y: auto;
            background: #ffffff;
        }

        .message {
            margin: 10px 0;
            padding: 12px;
            border-radius: 10px;
            max-width: 85%;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }

        .bot-message {
            background: #f4f4f4;
            margin-right: auto;
            color: #51A5D7;
        }

        .user-message {
            background: #A0CD9A;
            color: white;
            margin-left: auto;
        }

        .options-container {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-top: 10px;
        }

        .option-button {
            background: #f4f4f4;
            border: 2px solid #51A5D7;
            padding: 10px 15px;
            border-radius: 8px;
            cursor: pointer;
            text-align: left;
            transition: all 0.3s ease;
            color: #51A5D7;
            font-weight: 500;
            margin-bottom: 8px;
            width: 100%;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .option-button.selected {
            background: #51A5D7;
            color: white;
        }

        .option-button.continue-button {
            background: #A0CD9A;
            border-color: #A0CD9A;
            color: white;
            font-weight: bold;
            margin-top: 16px;
        }

        .selection-summary {
            margin: 10px 0;
            padding: 10px;
            background: #f4f4f4;
            border-radius: 8px;
            font-size: 0.9em;
            color: #51A5D7;
        }

        .checkmark {
            display: none;
            margin-left: 8px;
        }

        .option-button.selected .checkmark {
            display: inline;
        }

        .chat-toggle {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 60px;
            height: 60px;
            background: #51A5D7;
            border: none;
            border-radius: 50%;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        .chat-toggle:hover {
            background: #4590bd;
            transform: scale(1.1);
        }

        .input-field {
            width: 100%;
            padding: 8px;
            margin: 5px 0;
            border: 1px solid #e5e7eb;
            border-radius: 5px;
        }
    </style>
</head>

<body>
    <button class="chat-toggle" id="chatToggle">ðŸ’¬</button>

    <div class="chat-container" id="chatContainer">
        <div class="chat-header">
            Architecture Consultation Assistant
            <button class="close-button" onclick="toggleChat()">Ã—</button>
        </div>
        <div class="chat-messages" id="chatMessages"></div>
        
    </div>

    <style>
        .close-button {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
            padding: 0;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .close-button:hover {
            opacity: 0.8;
        }

        .chat-header {
            position: relative;
        }
    </style>

    <script>
        // Conversation flow definition
        const conversationFlow = {
            start: {
                message: "Hello! I'm here to understand your software architecture needs. Would you like to start a quick consultation?",
                options: ["Yes, let's begin", "I'd prefer to browse first"],
                next: {
                    "Yes, let's begin": "project_type",
                    "I'd prefer to browse first": "browse_info"
                }
            },
            browse_info: {
                message: "No problem! You can explore our services anytime. When you're ready to discuss your project, just click any option.",
                options: ["Start consultation", "Tell me about your expertise"],
                next: {
                    "Start consultation": "project_type",
                    "Tell me about your expertise": "expertise_info"
                }
            },
            expertise_info: {
                message: "We specialize in modern software architecture and infrastructure, including:\n- Cloud-native solutions\n- Microservices architecture\n- DevOps implementation\n- Scalable system design\nWould you like to discuss your specific needs?",
                options: ["Yes, let's discuss my project", "I have more questions"],
                next: {
                    "Yes, let's discuss my project": "project_type",
                    "I have more questions": "contact_expert"
                }
            },
            project_type: {
                message: "What would you like to achieve with our help?",
                options: [
                    "Build a new software solution",
                    "Add AI capabilities to existing systems",
                    "Improve existing software",
                    "Move systems to the cloud",
                    "Make current systems faster and better",
                    "Build an AI-powered solution from scratch",
                    "Not sure - need guidance"
                ],
                next: {
                    "Build a new software solution": "new_system_details",
                    "Add AI capabilities to existing systems": "ai_enhancement_needs",
                    "Improve existing software": "project_scale",
                    "Move systems to the cloud": "project_scale",
                    "Make current systems faster and better": "project_scale",
                    "Build an AI-powered solution from scratch": "ai_solution_details",
                    "Not sure - need guidance": "guidance_needed"
                }
            },
            ai_enhancement_needs: {
                message: "What kind of AI capabilities are you interested in adding? (Select all that apply)",
                options: [
                    "Automated customer support",
                    "Data analysis and insights",
                    "Process automation",
                    "Document processing and understanding",
                    "Predictive analytics",
                    "Image or video analysis",
                    "Other/Custom solution",
                    "Continue to next step"
                ],
                next: "data_availability",
                allowMultiple: true
            },
            data_availability: {
                message: "Do you already have data that could be used to train AI models?",
                options: [
                    "Yes, we have structured data",
                    "Yes, but it needs organization",
                    "No, we need to start collecting",
                    "Not sure what data we need",
                    "Would like to discuss data requirements"
                ],
                next: "project_scale"
            },
            ai_solution_details: {
                message: "Tell us about the AI-powered solution you envision:",
                type: "form",
                fields: [
                    { name: "description", label: "What problem should the AI solve?" },
                    { name: "expected_outcome", label: "What outcomes are you looking for?" }
                ],
                next: "ai_inspiration"
            },
            ai_inspiration: {
                message: "Have you seen similar AI solutions that inspired your idea?",
                options: [
                    "Yes, I can share examples",
                    "No, but interested in possibilities",
                    "This would be something unique",
                    "Not sure - need guidance"
                ],
                next: "data_availability"
            },
            new_system_details: {
                message: "Could you briefly describe what kind of software solution you're looking to build? (For example: customer portal, internal tool, mobile app, etc.)",
                type: "form",
                fields: [
                    { name: "description", label: "Brief description of your idea" }
                ],
                next: "similar_solutions"
            },
            similar_solutions: {
                message: "Are you aware of any similar solutions in the market that inspire your idea?",
                options: [
                    "Yes, I know similar solutions",
                    "No, but I'd like to learn about existing options",
                    "This would be something unique"
                ],
                next: "project_scale"
            },
            guidance_needed: {
                message: "No problem! Let's start with understanding your business needs. What's the main challenge you're trying to solve?",
                type: "form",
                fields: [
                    { name: "challenge", label: "What business challenge are you facing?" }
                ],
                next: "project_scale"
            },
            project_scale: {
                message: "How would you describe the size of your organization?",
                options: [
                    "Small business or startup",
                    "Growing company",
                    "Large organization",
                    "Public sector / Non-profit",
                    "Personal project",
                    "Not sure / Other"
                ],
                next: "timeline"
            },
            timeline: {
                message: "What's your expected timeline for this project?",
                options: [
                    "Immediate start (1-2 months)",
                    "Near future (3-6 months)",
                    "Long-term planning (6+ months)",
                    "Not sure yet"
                ],
                next: "current_challenges"
            },
            current_challenges: {
                message: "What challenges are you facing? (Select all that apply)",
                options: [
                    "Missing in technical expertise",
                    "System is too slow",
                    "Need better security",
                    "Hard to add new features",
                    "High maintenance costs",
                    "System crashes or errors",
                    "Difficulty managing data",
                    "Need automation",
                    "Manual processes taking too long",
                    "Need better insights from data",
                    "Continue to next step"
                ],
                next: "budget_range",
                allowMultiple: true
            },
            budget_range: {
                message: "Do you have a budget range in mind for this project?",
                options: [
                    "Under $50,000",
                    "Between $50,000 - $200,000",
                    "Over $200,000",
                    "Not decided yet",
                    "Would like to discuss options"
                ],
                next: "contact_info"
            },
            contact_info: {
                message: "Great! To schedule a detailed consultation, I'll need some contact information. Could you provide:",
                type: "form",
                fields: [
                    { name: "name", label: "Your Name" },
                    { name: "email", label: "Email Address" },
                    { name: "company", label: "Company Name" }
                ],
                next: "summary"
            },
            summary: {
                message: "Thank you! I've collected all the necessary information. Our team will review your needs and contact you within 24 hours. Would you like to see a summary of your responses?",
                options: ["Yes, show summary", "No, I'm done"],
                next: {
                    "Yes, show summary": "show_summary",
                    "No, I'm done": "farewell"
                }
            },
            contact_expert: {
                message: "I'll have one of our software architects contact you directly. Could you provide your contact information?",
                type: "form",
                fields: [
                    { name: "name", label: "Your Name" },
                    { name: "email", label: "Email Address" },
                    { name: "company", label: "Company Name" }
                ],
                next: "farewell"
            },
            farewell: {
                message: "Thank you for your interest! We'll be in touch soon. Have a great day!",
                options: ["Start a new consultation"],
                next: {
                    "Start a new consultation": "start"
                }
            },
            show_summary: {
                message: "Here's a summary of your consultation:",
                options: ["Start new consultation", "Close"],
                next: {
                    "Start new consultation": "start",
                    "Close": "farewell"
                }
            },
        };

        // Store user responses
        let userResponses = {
            timestamp: new Date().toISOString(),
            answers: {}
        };

        let currentStep = 'start';
        let isOpen = false;

        // DOM elements
        const chatToggle = document.getElementById('chatToggle');
        const chatContainer = document.getElementById('chatContainer');
        const chatMessages = document.getElementById('chatMessages');
        const chatInput = document.getElementById('chatInput');
        const userInput = document.getElementById('userInput');

        function toggleChat() {
            isOpen = !isOpen;
            chatContainer.style.display = isOpen ? 'flex' : 'none';
            if (isOpen && chatMessages.children.length === 0) {
                showStep(currentStep);
            }
        }

        // Toggle chat
        chatToggle.addEventListener('click', () => {
            toggleChat();
        });

        function addMessage(text, sender) {
            const messageDiv = document.createElement('div');
            messageDiv.classList.add('message', `${sender}-message`);
            messageDiv.textContent = text;
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function showOptions(options, allowMultiple = false) {
            const optionsContainer = document.createElement('div');
            optionsContainer.classList.add('options-container');

            // Add selection summary container if multiple selection is allowed
            let selectionSummary;
            if (allowMultiple) {
                selectionSummary = document.createElement('div');
                selectionSummary.classList.add('selection-summary');
                selectionSummary.style.display = 'none';
                optionsContainer.appendChild(selectionSummary);
            }

            options.forEach(option => {
                const button = document.createElement('button');
                button.classList.add('option-button');
                if (option.toLowerCase().includes('continue')) {
                    button.classList.add('continue-button');
                }

                const buttonText = document.createElement('span');
                buttonText.textContent = option;

                const checkmark = document.createElement('span');
                checkmark.textContent = 'âœ“';
                checkmark.classList.add('checkmark');

                button.appendChild(buttonText);
                button.appendChild(checkmark);

                button.onclick = () => {
                    if (allowMultiple) {
                        if (option.toLowerCase().includes('continue')) {
                            // Handle continue button click
                            const selectedOptions = Array.from(optionsContainer.querySelectorAll('.option-button.selected'))
                                .map(btn => btn.querySelector('span').textContent)
                                .filter(text => !text.toLowerCase().includes('continue'));

                            if (selectedOptions.length > 0) {
                                handleOption(selectedOptions, true);
                            }
                        } else {
                            // Toggle selection
                            button.classList.toggle('selected');

                            // Update selection summary
                            const selectedOptions = Array.from(optionsContainer.querySelectorAll('.option-button.selected'))
                                .map(btn => btn.querySelector('span').textContent)
                                .filter(text => !text.toLowerCase().includes('continue'));

                            if (selectedOptions.length > 0) {
                                selectionSummary.textContent = 'Selected: ' + selectedOptions.join(', ');
                                selectionSummary.style.display = 'block';
                            } else {
                                selectionSummary.style.display = 'none';
                            }
                        }
                    } else {
                        handleOption(option, false);
                    }
                };
                optionsContainer.appendChild(button);
            });

            chatMessages.appendChild(optionsContainer);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function showForm(fields) {
            const form = document.createElement('div');
            form.classList.add('options-container');

            fields.forEach(field => {
                const input = document.createElement('input');
                input.type = field.name === 'email' ? 'email' : 'text';
                input.placeholder = field.label;
                input.classList.add('input-field');
                form.appendChild(input);
            });

            const submitButton = document.createElement('button');
            submitButton.classList.add('option-button');
            submitButton.textContent = 'Submit';
            submitButton.onclick = () => {
                const formData = {};
                form.querySelectorAll('input').forEach(input => {
                    formData[input.type] = input.value;
                });
                handleFormSubmit(formData);
            };
            form.appendChild(submitButton);

            chatMessages.appendChild(form);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function handleFormSubmit(formData) {
            userResponses.answers[currentStep] = formData;
            saveResponses();

            const nextStep = conversationFlow[currentStep].next;
            currentStep = nextStep;
            showStep(currentStep);
        }

        function handleOption(option, allowMultiple) {
            if (allowMultiple && Array.isArray(option)) {
                addMessage("Selected: " + option.join(", "), 'user');
                userResponses.answers[currentStep] = option;
                const nextStep = conversationFlow[currentStep].next;
                currentStep = nextStep;
                showStep(currentStep);
            } else if (!allowMultiple) {
                addMessage(option, 'user');
            }

            if (currentStep === 'summary' && option === "Yes, show summary") {
                addMessage(showSummary(), 'bot');
            }

            if (allowMultiple && option !== "Continue to contact info") {
                if (!userResponses.answers[currentStep]) {
                    userResponses.answers[currentStep] = [];
                }
                userResponses.answers[currentStep].push(option);
                return;
            }

            let nextStep;
            if (typeof conversationFlow[currentStep].next === 'string') {
                nextStep = conversationFlow[currentStep].next;
            } else {
                nextStep = conversationFlow[currentStep].next[option];
            }

            if (!allowMultiple) {
                userResponses.answers[currentStep] = option;
            }

            saveResponses();
            if (nextStep) {
                currentStep = nextStep;
                showStep(currentStep);
            }
        }

        function showStep(step) {
            const currentStepData = conversationFlow[step];
            addMessage(currentStepData.message, 'bot');

            if (currentStepData.type === 'form') {
                showForm(currentStepData.fields);
            } else if (currentStepData.options) {
                showOptions(currentStepData.options, currentStepData.allowMultiple);
            }
        }

        function saveResponses() {
            // In a real implementation, you might want to send this to your server
            console.log('Saved responses:', userResponses);
            localStorage.setItem('chatbot_responses', JSON.stringify(userResponses));
        }

        function showSummary() {
            let summaryText = "Your consultation summary:\n\n";
            for (const [key, value] of Object.entries(userResponses.answers)) {
                if (value && conversationFlow[key]) {
                    summaryText += `${conversationFlow[key].message}\n`;
                    summaryText += `Answer: ${Array.isArray(value) ? value.join(", ") : value}\n\n`;
                }
            }
            return summaryText;
        }

        // Handle enter key
        userInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });
    </script>
</body>

</html>